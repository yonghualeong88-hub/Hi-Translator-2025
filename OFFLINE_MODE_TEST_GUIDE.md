# 🧪 离线模式测试指南

## 📋 测试前准备

### 1. **启动应用**
```bash
npx expo start
```
扫描二维码在手机上打开应用

### 2. **下载离线资源**

#### **下载Vosk语音模型**
1. 进入：**设置 > Vosk模型管理**
2. 推荐下载：
   - ✅ **vosk-model-small-multilang-0.22** (128MB)
     - 支持12种语言：英语、中文、日语、韩语、法语、德语、西班牙语、意大利语、葡萄牙语、俄语、阿拉伯语、印地语
   - 或下载单语言模型（更快）：
     - **vosk-model-small-en-us-0.15** (40MB) - 英语
     - **vosk-model-small-cn-0.22** (45MB) - 中文

#### **下载离线翻译语言包**（如需要）
1. 进入：**设置 > 语言包管理**
2. 下载需要的语言对
3. 查看存储使用情况

---

## 🧪 离线模式测试清单

### ✅ **测试1：离线语音识别**

#### **步骤：**
1. **准备：**
   - ✅ 确保已下载Vosk模型
   - ✅ 关闭WiFi和移动数据
   - ✅ 启用飞行模式

2. **测试语音输入：**
   - 📱 进入**语音**标签页
   - 🎤 选择源语言（如：中文）
   - 🎤 选择目标语言（如：英语）
   - 🔴 **长按录音按钮**说话
   - 检查是否能正确识别语音

3. **预期结果：**
   - ✅ 语音能被正确识别成文本
   - ✅ 显示"使用离线识别"或类似提示
   - ✅ 识别速度应该较快（本地处理）
   - ❌ 翻译可能失败（需要离线翻译包或在线）

4. **测试多种语言：**
   - 🇨🇳 中文
   - 🇺🇸 英语
   - 🇯🇵 日语
   - 🇰🇷 韩语

---

### ✅ **测试2：离线翻译（如已下载语言包）**

#### **步骤：**
1. **准备：**
   - ✅ 确保已下载离线语言包
   - ✅ 保持飞行模式开启

2. **测试文本翻译：**
   - 📱 进入**文本**标签页
   - ✍️ 输入一段文字
   - 🌐 选择源语言和目标语言
   - 🔄 点击翻译

3. **预期结果：**
   - ✅ 翻译成功完成
   - ✅ 显示"离线翻译"提示
   - ✅ 翻译速度较快
   - ✅ 翻译质量应该可接受

---

### ✅ **测试3：相机OCR（可能需要在线）**

#### **步骤：**
1. **测试拍照：**
   - 📱 进入**相机**标签页
   - 📷 拍摄包含文字的照片
   - 🔍 检查是否能识别文字

2. **预期结果：**
   - ✅ 能拍照成功
   - ⚠️ OCR识别可能需要在线
   - 📝 如有离线OCR，应能识别文字

---

### ✅ **测试4：短语功能（完全离线）**

#### **步骤：**
1. **测试短语显示：**
   - 📱 进入**短语**标签页
   - 👀 查看场景卡片
   - 🌍 切换应用语言（设置 > 应用语言）

2. **预期结果：**
   - ✅ 场景卡片正确显示
   - ✅ 场景卡片标题和描述根据app_language动态翻译
   - ✅ 内置短语正确显示
   - ✅ 可以添加自定义短语

3. **测试场景卡片：**
   - 🚗 出行交通
   - 🛍️ 购物消费
   - 🍴 餐饮美食
   - 🚨 紧急情况
   - 🏨 住宿酒店
   - 💬 日常交流
   - 🏥 医疗健康

---

### ✅ **测试5：历史记录（完全离线）**

#### **步骤：**
1. **查看历史：**
   - 📱 进入**文本**或**语音**标签页
   - 📜 向下滚动查看历史记录
   - 🔍 点击历史记录查看详情

2. **预期结果：**
   - ✅ 历史记录正常显示
   - ✅ 时间格式正确（如"2天前"）
   - ✅ 可以播放历史语音（如有）
   - ✅ 可以复制历史文本

---

### ✅ **测试6：设置和界面（完全离线）**

#### **步骤：**
1. **测试设置：**
   - ⚙️ 进入**设置**
   - 🎨 切换主题（浅色/深色/系统）
   - 🌍 切换应用语言
   - 🔊 调整自动播放设置

2. **测试语言切换：**
   - 🇨🇳 切换到中文 → 界面应显示中文
   - 🇺🇸 切换到英语 → 界面应显示英语
   - 🇯🇵 切换到日语 → 界面应显示日语
   - 🇰🇷 切换到韩语 → 界面应显示韩语

3. **预期结果：**
   - ✅ 所有设置正常工作
   - ✅ 语言切换立即生效
   - ✅ 场景卡片跟随语言变化
   - ✅ UI完全国际化

---

## 🐛 可能遇到的问题

### **问题1：语音识别失败**
**可能原因：**
- ❌ Vosk模型未下载
- ❌ Vosk模型未正确初始化
- ❌ 音频格式不支持

**解决方法：**
1. 检查模型是否已下载：**设置 > Vosk模型管理**
2. 重新初始化模型
3. 重启应用

---

### **问题2：翻译失败**
**可能原因：**
- ❌ 没有离线翻译包
- ❌ 需要在线翻译服务

**解决方法：**
1. 下载离线语言包：**设置 > 语言包管理**
2. 或暂时开启网络进行在线翻译
3. 检查日志错误信息

---

### **问题3：OCR识别失败**
**可能原因：**
- ❌ OCR服务需要在线

**解决方法：**
1. 开启网络使用在线OCR
2. 或检查是否有离线OCR配置

---

### **问题4：场景卡片显示英文**
**可能原因：**
- ❌ 翻译文件未加载
- ❌ 应用语言设置错误

**解决方法：**
1. 检查应用语言设置
2. 重启应用
3. 清除缓存重新加载

---

## 📊 离线功能对比表

| 功能 | 完全离线 | 需要在线 | 备注 |
|------|---------|---------|------|
| 语音识别 | ✅ (Vosk) | ⚠️ (高质量) | Vosk提供基础离线识别 |
| 文本翻译 | ⚠️ (需下载) | ✅ | 需下载离线语言包 |
| 相机OCR | ❌ | ✅ | 通常需要在线服务 |
| 短语功能 | ✅ | ✅ | 完全离线可用 |
| 历史记录 | ✅ | ✅ | 本地存储 |
| 界面显示 | ✅ | ✅ | 完全离线可用 |
| 语音播放 | ✅ | ✅ | TTS可能需要在线 |

---

## ✅ 离线模式最佳实践

### **推荐配置：**

1. **必须下载：**
   - ✅ Vosk多语言模型（128MB）
   - ✅ 常用语言包（根据需要）

2. **可选下载：**
   - 单语言Vosk模型（更快）
   - 额外语言包

3. **测试流程：**
   - ✅ 先在线模式下下载所有资源
   - ✅ 验证资源下载成功
   - ✅ 开启飞行模式
   - ✅ 逐一测试各项功能
   - ✅ 记录问题和日志

4. **性能优化：**
   - 小模型识别更快但准确度略低
   - 大模型准确度高但占用空间
   - 根据设备性能选择合适模型

---

## 🎯 测试成功标准

### **基础要求：**
- ✅ 离线语音识别成功率 > 70%
- ✅ UI完全可用，无白屏
- ✅ 场景卡片正确翻译
- ✅ 历史记录正常显示

### **高级要求：**
- ✅ 离线翻译成功（如已下载语言包）
- ✅ 语音识别准确度 > 85%
- ✅ 所有语言切换正常
- ✅ 无崩溃，无重大bug

---

## 📝 测试报告模板

```markdown
## 离线模式测试报告

**测试日期：** YYYY-MM-DD  
**测试设备：** [设备型号]  
**Android版本：** [版本]  
**应用版本：** [版本]

### 测试结果

#### ✅ 通过的测试
- [ ] 语音识别（中文）
- [ ] 语音识别（英语）
- [ ] 短语功能
- [ ] 历史记录
- [ ] 语言切换
- [ ] 场景卡片翻译

#### ❌ 失败的测试
- [ ] [描述失败项]
- [ ] [原因分析]

#### 📊 性能数据
- 语音识别速度：XX秒
- 识别准确率：XX%
- 内存占用：XX MB
- 存储占用：XX MB

#### 🐛 发现的问题
1. [问题描述]
2. [复现步骤]
3. [错误日志]

#### 💡 改进建议
1. [建议1]
2. [建议2]
```

---

## 🚀 开始测试

1. ✅ 启动Expo：`npx expo start`
2. ✅ 扫描二维码打开应用
3. ✅ 下载Vosk模型和语言包
4. ✅ 开启飞行模式
5. ✅ 按照清单逐项测试
6. ✅ 记录测试结果

**祝测试顺利！🎉**

