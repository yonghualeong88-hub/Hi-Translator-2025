# 相机问题故障排除指南

## 🚫 相机被限制错误 (camera-is-restricted)

当您看到 `camera-is-restricted` 错误时，这表示相机功能被操作系统限制了。

### 🔍 可能的原因

1. **设备管理员策略限制**
   - 企业设备管理策略
   - 设备管理员应用限制
   - 安全策略设置

2. **家长控制设置**
   - 儿童模式启用
   - 家长控制限制相机访问
   - 应用使用时间限制

3. **系统级限制**
   - 其他应用正在使用相机
   - 系统资源不足
   - 硬件问题

4. **权限问题**
   - 相机权限被拒绝
   - 权限被系统撤销
   - 应用权限配置错误

### 🛠️ 解决方案

#### 1. 检查设备设置

**Android设备:**
```bash
# 检查设备管理员
设置 > 安全 > 设备管理员

# 检查应用权限
设置 > 应用 > 权限管理器 > 相机

# 检查家长控制
设置 > 数字健康和家长控制
```

**iOS设备:**
```bash
# 检查限制
设置 > 屏幕使用时间 > 内容和隐私访问限制

# 检查相机权限
设置 > 隐私 > 相机
```

#### 2. 企业设备解决方案

如果是企业设备：
1. 联系IT管理员
2. 检查企业设备管理策略
3. 请求相机权限例外

#### 3. 应用级解决方案

**重启应用:**
```bash
# 完全关闭应用
# 重新启动应用
```

**清除应用数据:**
```bash
# Android
设置 > 应用 > 应用信息 > 存储 > 清除数据

# iOS
删除并重新安装应用
```

#### 4. 系统级解决方案

**重启设备:**
```bash
# 完全关闭设备
# 等待30秒
# 重新启动
```

**检查其他应用:**
```bash
# 关闭所有相机应用
# 检查后台应用
# 重启相机服务
```

### 🔧 诊断工具

使用我们提供的诊断脚本：

```bash
# 运行相机诊断
node scripts/diagnose-camera.js
```

### 🎯 降级方案

当相机不可用时，应用提供以下替代方案：

1. **文本输入模式**
   - 手动输入需要翻译的文本
   - 支持多语言翻译
   - 保持核心翻译功能

2. **图片上传模式**
   - 从相册选择图片
   - 上传图片进行OCR翻译
   - 避免实时相机需求

3. **语音输入模式**
   - 使用语音输入
   - 语音转文字翻译
   - 无需相机权限

### 📱 测试步骤

1. **权限测试**
   ```bash
   # 检查相机权限
   adb shell dumpsys package | grep CAMERA
   ```

2. **设备策略测试**
   ```bash
   # 检查设备策略
   adb shell dumpsys device_policy
   ```

3. **应用权限测试**
   ```bash
   # 检查应用权限
   adb shell dumpsys package com.hltransslater.app
   ```

### 🚨 紧急解决方案

如果所有方法都失败：

1. **使用文本模式**
   - 点击"📝 使用文本输入模式"
   - 手动输入文本进行翻译

2. **联系支持**
   - 提供错误日志
   - 说明设备型号和系统版本
   - 描述问题复现步骤

3. **替代应用**
   - 使用其他翻译应用
   - 等待系统更新
   - 联系设备制造商

### 📋 错误日志收集

当遇到问题时，请收集以下信息：

```json
{
  "device": "设备型号",
  "os": "操作系统版本",
  "app_version": "应用版本",
  "error_message": "完整错误信息",
  "timestamp": "错误发生时间",
  "steps": "复现步骤"
}
```

### 🔄 预防措施

1. **定期更新应用**
2. **保持系统更新**
3. **避免安装可疑应用**
4. **定期检查权限设置**
5. **备份重要数据**

---

## 📞 获取帮助

如果您需要进一步帮助：

1. 查看应用内帮助文档
2. 联系技术支持
3. 访问社区论坛
4. 提交问题报告

**记住：相机限制通常是系统级问题，不是应用本身的问题。**
