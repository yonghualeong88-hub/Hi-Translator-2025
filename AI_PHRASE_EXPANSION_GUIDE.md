# 🤖 AI短语扩展功能使用指南

## 📋 功能概述

AI短语扩展功能允许用户输入一个简单的短语，然后AI会生成该短语在不同场景下的多种表达方式，帮助用户学习更自然、更地道的语言表达。

## 🚀 使用方法

### 1. 启动后端服务

```bash
# 方法1: 使用启动脚本
node start-backend.js

# 方法2: 手动启动
cd backend
npm run dev
```

后端服务将在 `http://localhost:3001` 启动

### 2. 在应用中使用

1. 打开Phrases页面
2. 点击右上角的 `+` 按钮
3. 在添加短语模态框中，输入原文
4. 点击 `🤖 AI扩展` 按钮
5. 等待AI生成扩展短语
6. 浏览不同场景的短语
7. 点击播放按钮听发音
8. 点击收藏按钮保存喜欢的短语

## 🎯 功能特点

### ✨ 智能扩展
- 输入简单短语，生成多种场景表达
- 支持餐厅、机场、紧急情况等常见场景
- 每个场景提供2-3个自然表达方式

### 🎵 语音播放
- 支持播放原文和译文
- 使用系统TTS或OpenAI TTS
- 一键播放，方便学习发音

### ⭐ 收藏管理
- 一键收藏喜欢的短语
- 自动保存到个人短语本
- 支持分类管理

### 🔍 搜索功能
- 支持按原文或译文搜索
- 实时搜索，快速找到目标短语

## 🛠️ 技术实现

### 前端 (React Native)
- 使用 `fetch` API 调用后端服务
- 支持错误处理和fallback数据
- 响应式UI设计，适配不同设备

### 后端 (Next.js API)
- 使用 OpenAI GPT-4o-mini 模型
- 智能Prompt设计，确保输出质量
- 错误处理和默认数据fallback

### API接口
```
POST /api/expand-phrase
Content-Type: application/json

{
  "phrase": "I want water",
  "lang": "en"
}
```

响应格式：
```json
[
  {
    "scene": "餐厅",
    "phrases": ["Can I get a glass of water, please?", "Still or sparkling water?"],
    "translations": ["请给我一杯水", "要矿泉水还是气泡水？"]
  },
  {
    "scene": "机场",
    "phrases": ["Where can I get drinking water?", "Is there a water fountain nearby?"],
    "translations": ["哪里可以买到饮用水？", "附近有饮水机吗？"]
  }
]
```

## 💰 成本控制

### OpenAI API费用
- 使用 `gpt-4o-mini` 模型，成本较低
- 每次请求约 $0.002-0.01 美金
- 建议实施使用限制：
  - 免费用户：每日5次免费扩展
  - 付费用户：无限制使用

### 优化策略
1. **缓存机制**：相同短语的扩展结果可以缓存
2. **批量处理**：支持批量扩展多个短语
3. **本地fallback**：网络失败时使用预设数据

## 🔧 配置说明

### 环境变量
在 `backend/.env.local` 中配置：
```
OPENAI_API_KEY=your_openai_api_key_here
```

### 自定义配置
- 修改 `backend/pages/api/expand-phrase.ts` 中的Prompt
- 调整生成场景和短语数量
- 自定义fallback数据

## 🎨 UI设计

### 扩展模态框
- 输入框：支持多行文本输入
- 扩展按钮：显示加载状态
- 结果展示：按场景分组显示
- 操作按钮：播放、收藏、复制

### 短语卡片
- 场景标题：突出显示
- 短语内容：原文和译文对比
- 操作区域：播放、收藏按钮

## 🚀 未来扩展

### 高级功能
1. **多语言支持**：支持中文输入，扩展英文表达
2. **场景自定义**：用户可自定义扩展场景
3. **语音输入**：支持语音输入要扩展的短语
4. **批量扩展**：一次扩展多个短语
5. **云端同步**：付费用户支持多设备同步

### 集成功能
1. **翻译历史集成**：从翻译结果直接扩展
2. **学习进度**：记录用户学习进度
3. **智能推荐**：基于使用习惯推荐短语
4. **社交分享**：分享扩展结果给朋友

## 🐛 故障排除

### 常见问题
1. **API调用失败**：检查后端服务是否启动
2. **网络连接问题**：确认网络连接正常
3. **OpenAI API错误**：检查API密钥配置
4. **JSON解析错误**：查看控制台错误信息

### 调试方法
1. 查看浏览器控制台错误
2. 检查后端服务日志
3. 验证API响应格式
4. 测试网络连接

## 📞 技术支持

如果遇到问题，请：
1. 检查本文档的故障排除部分
2. 查看控制台错误信息
3. 确认环境配置正确
4. 联系技术支持团队
